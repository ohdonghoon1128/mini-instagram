(function(){angular.module("instagramApp",["ngRoute","ngSanitize","ui.bootstrap"]);function t(t){t.when("/",{templateUrl:"/app_client/home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"})}angular.module("instagramApp").config(["$routeProvider",t])})();(function(){angular.module("instagramApp").controller("homeCtrl",t);t.$inject=["$http"];function t(t){const n=this;n.pageHeader={title:"mini-instagram"};n.data={photos:["test/pic-1.jpg","test/pic-2.jpg","test/pic-3.jpg","test/pic-4.jpg","test/pic-5.jpg","test/pic-6.jpg","test/pic-7.jpg"]}}})();(function(){angular.module("instagramApp").controller("loginModalCtrl",t);t.$inject=["$uibModalInstance","authentication"];function t(t,n){const e=this;e.formData={};e.onSubmit=function(){e.formError="";if(!e.formData.userid||!e.formData.password){e.formError="userid and password are required!";return false}else{n.login(e.formData).then(n=>{t.close()}).then(null,t=>{e.formError=t.data.message});return false}};e.cancel=function(){t.dismiss("cancel")}}})();(function(){angular.module("instagramApp").controller("registerModalCtrl",t);t.$inject=["$uibModalInstance","authentication"];function t(t,n){const e=this;e.formData={};e.onSubmit=function(){e.formError="";if(!e.formData.userid||!e.formData.email||!e.formData.password){e.formError="userid, email and password are required!"}else if(e.formData.password!==e.confirmPassword){e.formError="Your password does not match each other."}else{n.register(e.formData).then(n=>{t.close()}).then(null,t=>{e.formError=t.data.message})}return false};e.cancel=function(){t.dismiss("cancel")}}})();(function(){angular.module("instagramApp").directive("navigation",t);function t(){return{restrict:"EA",templateUrl:"/app_client/common/directives/navigation.template.html",controller:"navigationCtrl as navvm"}}})();(function(){angular.module("instagramApp").controller("navigationCtrl",t);t.$inject=["authentication","$location","$uibModal","$window"];function t(t,n,e,o){const r=this;r.isLoggedIn=t.isLoggedIn();r.currentPath=n.path();r.currentUser=t.currentUser();r.logout=function(){t.logout();o.location.assign("/");o.reload()};r.login=function(){const t=e.open({templateUrl:"/app_client/loginModal/loginModal.view.html",controller:"loginModalCtrl as vm"});t.result.then(t=>{o.location.assign(r.currentPath);o.reload()})};r.register=function(){const t=e.open({templateUrl:"/app_client/registerModal/registerModal.view.html",controller:"registerModalCtrl as vm"});t.result.then(t=>{o.location.assign(r.currentPath);o.reload()})}}})();(function(){angular.module("instagramApp").directive("footerGeneric",t);function t(){return{restrict:"EA",templateUrl:"/app_client/common/directives/footerGeneric.template.html"}}})();(function(){angular.module("instagramApp").service("authentication",t);t.$inject=["$http","$window"];function t(t,n){const e=function(){return n.localStorage.userToken};const o=function(t){if(!t){throw new Error(`invalid token(${t})`)}n.localStorage.userToken=t};const r=function(n){return t.post(`/api/account/register`,n).then(t=>{o(t.data.token);return t})};const a=function(n){return t.post(`/api/account/login`,n).then(t=>{o(t.data.token);return t})};const i=function(){n.localStorage.removeItem("userToken")};const l=function(){const t=e();if(!t){return false}const o=JSON.parse(n.atob(t.split(".")[1]));return o.exp>Date.now()};const s=function(){const t=e();if(!t){return}const o=JSON.parse(n.atob(t.split(".")[1]));return{userid:o.userid,email:o.email}};return{getToken:e,saveToken:o,register:r,login:a,logout:i,isLoggedIn:l,currentUser:s}}})();